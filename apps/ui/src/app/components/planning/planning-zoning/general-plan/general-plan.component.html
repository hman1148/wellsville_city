<div class="page-container">
	<div class="page-header">
		<h1>
			<i class="pi pi-map-marker" aria-hidden="true"></i>
			General Plan
		</h1>
		<p class="page-description">
			Explore Wellsville City's comprehensive General Plan and land use mapping
		</p>
	</div>

	<div class="content-section">
		<!-- General Plan Document Section -->
		<p-card styleClass="document-card">
			<ng-template pTemplate="header">
				<div class="card-header-content">
					<i class="pi pi-file-pdf" aria-hidden="true"></i>
					<h2>{{ state.generalPlanDoc().title }}</h2>
				</div>
			</ng-template>

			<div class="document-info">
				<p class="description">{{ state.generalPlanDoc().description }}</p>

				<div class="document-meta">
					<div class="meta-item">
						<i class="pi pi-file" aria-hidden="true"></i>
						<span>PDF Document</span>
					</div>
					<div class="meta-item">
						<i class="pi pi-database" aria-hidden="true"></i>
						<span>{{ state.generalPlanDoc().fileSize }}</span>
					</div>
					<div class="meta-item">
						<i class="pi pi-calendar" aria-hidden="true"></i>
						<span>Last Updated: {{ state.generalPlanDoc().lastUpdated }}</span>
					</div>
				</div>

				<p-divider></p-divider>

				<div class="action-buttons">
					<p-button
						label="View General Plan"
						icon="pi pi-eye"
						severity="primary"
						(onClick)="openPdfViewer()"
						styleClass="view-button"
					/>
					<p-button
						label="Download PDF"
						icon="pi pi-download"
						severity="secondary"
						(onClick)="downloadPdf()"
						styleClass="download-button"
					/>
				</div>

				<div class="external-link">
					<p class="info-text">
						<i class="pi pi-info-circle" aria-hidden="true"></i>
						The General Plan provides comprehensive guidance for the city's future development, including policies for land use, community facilities, parks, and infrastructure.
					</p>
				</div>
			</div>
		</p-card>

		<!-- Land Use Map Section -->
		<p-card styleClass="land-use-card">
			<ng-template pTemplate="header">
				<div class="card-header-content">
					<i class="pi pi-map" aria-hidden="true"></i>
					<h2>{{ state.landUseMap().title }}</h2>
				</div>
			</ng-template>

			<div class="land-use-info">
				<p class="description">{{ state.landUseMap().description }}</p>

				<!-- Land Use Map Preview -->
				<div class="map-preview">
					<img
						[src]="state.landUseMap().imageUrl"
						[alt]="state.landUseMap().imageAlt"
						class="map-thumbnail"
						(click)="openLandUseMap()"
					/>
					<div class="map-overlay" (click)="openLandUseMap()">
						<i class="pi pi-search-plus" aria-hidden="true"></i>
						<span>Click to view full size</span>
					</div>
				</div>

				<p-divider></p-divider>

				<div class="action-buttons">
					<p-button
						label="View Full Size"
						icon="pi pi-search-plus"
						severity="primary"
						(onClick)="openLandUseMap()"
						styleClass="view-button"
					/>
					<p-button
						label="Download Map"
						icon="pi pi-download"
						severity="secondary"
						(onClick)="downloadLandUseMap()"
						styleClass="download-button"
					/>
				</div>

				<div class="external-link">
					<p class="info-text">
						<i class="pi pi-info-circle" aria-hidden="true"></i>
						This land use map illustrates the planned distribution of residential, commercial, industrial, and open space areas throughout Wellsville City.
					</p>
				</div>
			</div>
		</p-card>
	</div>
</div>

<!-- PDF Viewer Dialog -->
<p-dialog
	[visible]="state.showPdfViewer()"
	(onHide)="closePdfViewer()"
	[modal]="true"
	[dismissableMask]="true"
	[draggable]="false"
	[resizable]="false"
	styleClass="pdf-dialog"
	[breakpoints]="{ '960px': '90vw' }"
	[style]="{ width: '90vw', height: '90vh' }"
>
	<ng-template pTemplate="header">
		<div class="dialog-header">
			<i class="pi pi-file-pdf" aria-hidden="true"></i>
			<span>{{ state.generalPlanDoc().title }}</span>
		</div>
	</ng-template>

	<div class="pdf-viewer-container">
		<iframe
			[src]="pdfViewerUrl()"
			type="application/pdf"
			class="pdf-iframe"
			title="General Plan PDF"
		></iframe>
	</div>

	<ng-template pTemplate="footer">
		<div class="dialog-footer">
			<p-button
				label="Download"
				icon="pi pi-download"
				severity="secondary"
				(onClick)="downloadPdf()"
			/>
			<p-button
				label="Close"
				icon="pi pi-times"
				severity="secondary"
				(onClick)="closePdfViewer()"
			/>
		</div>
	</ng-template>
</p-dialog>

<!-- Land Use Map Dialog -->
<p-dialog
	[visible]="state.showLandUseMapDialog()"
	(onHide)="closeLandUseMap()"
	[modal]="true"
	[dismissableMask]="true"
	[draggable]="false"
	[resizable]="false"
	styleClass="map-dialog"
	[breakpoints]="{ '960px': '95vw' }"
	[style]="{ width: '95vw', maxWidth: '1400px' }"
>
	<ng-template pTemplate="header">
		<div class="dialog-header">
			<i class="pi pi-map" aria-hidden="true"></i>
			<span>{{ state.landUseMap().title }}</span>
		</div>
	</ng-template>

	<div class="map-viewer-container">
		<p-image
			[src]="state.landUseMap().imageUrl"
			[alt]="state.landUseMap().imageAlt"
			[preview]="true"
			styleClass="land-use-map-image"
		></p-image>
	</div>

	<ng-template pTemplate="footer">
		<div class="dialog-footer">
			<p-button
				label="Download Map"
				icon="pi pi-download"
				severity="secondary"
				(onClick)="downloadLandUseMap()"
			/>
			<p-button
				label="Close"
				icon="pi pi-times"
				severity="secondary"
				(onClick)="closeLandUseMap()"
			/>
		</div>
	</ng-template>
</p-dialog>
